# **스코어 기반 경로 탐색: 적대적 오토인코더의 매니폴드 불일치(Misalignment)에 대한 실증적 분석**

## **초록 (Abstract)**

생성 모델의 잠재 공간($Z$)을 탐색하는 표준적인 보간법(예: LERP)은 종종 비현실적인 시각적 아티팩트(artifact)를 생성합니다. 이러한 실패는 두 잠재 벡터($z\_A, z\_B$) 사이의 기하학적 경로가 생성기($G$)가 유효한 데이터로 디코딩하도록 학습되지 않은 저밀도 영역("구멍")을 통과하기 때문에 발생합니다. 우리는 이 "구멍"을 회피하기 위해, 적대적 오토인코더(AAE)의 \*\*잠재 공간 판별자($D\_z$)\*\*를 "신뢰할 수 있는 센서"로 사용하는 \*\*스코어 기반 동적 경로 탐색 알고리즘(SGW)\*\*을 제안합니다. 본 알고리즘은 $z\_t$를 목적지($z\_B$)로 이끄는 \*\*목표 지향 힘($\\vec{F}\_{\\text{target}}$)\*\*과, $z\_t$를 $D\_z$가 정의한 "이상적인 매니폴드"($\\mathcal{M}\_z$, 즉 $D\_z \\approx 0.5$)로 되돌리는 **매니폴드 보정 힘(**$\\vec{F}\_{\\text{correct}}$**)** 사이의 균형을 맞춥니다.

우리는 MNIST 데이터셋에 대한 일련의 실증적 실험을 통해, 이 가설의 **성공과 결정적인 한계**를 모두 증명합니다. 첫째, 우리는 $D\_z$가 "신뢰할 수 있게" 학습된 모델(Linear 모델)에서, $\\vec{F}\_{\\text{correct}}$가 성공적으로 \\\*\\\*활성화($\\neq 0$)\*\*되어 "구멍"(Outlier)에 빠진 $z\_t$를 $\\mathcal{M}\_z$로 복원시킴을 **D(z) 스코어 플롯**을 통해 정량적으로 보여줍니다(SGW $\\neq$ LERP).

하지만, 우리는 $D\_z$에 의해 "성공적으로" 복원된 이 경로($z\_{\\text{SGW}}$)조차 디코딩했을 때($G(z\_{\\text{SGW}})$), LERP와 **시각적으로 동일한 아티팩트**가 생성됨을 **이미지 그리드 플롯**을 통해 밝혀냈습니다. 이는 AAE의 근본적인 한계, 즉 $D\_z$가 감시하는 \*\*"사전 분포 매니폴드"($\\mathcal{M}\_z$)\*\*와 $G$가 학습한 \*\*"시각적 충실도 매니폴드"($\\mathcal{M}\_x$, 즉 '진짜 숫자')\*\*가 \*\*서로 일치하지 않음(misaligned)\*\*을 증명합니다. 본 연구는 $D\_z$ 스코어만으로는 "신뢰할 수 있는" 탐색을 보장할 수 없으며, $G(z)$(픽셀)를 직접 평가하는 "디코더 인지 보정($D\_x$)"이 필요함을 시사합니다.

## **1\. 서론 (Introduction)**

생성 모델, 특히 VAE(Variational Autoencoder)와 GAN(Generative Adversarial Network)의 성공은 복잡한 데이터 분포를 학습하는 능력에 기반합니다. 이 모델들이 학습한 잠재 공간($Z$)은 데이터의 고수준 의미론적 속성을 포착하며, $Z$ 공간을 탐색하는 것은 모델의 표현력을 이해하고 제어된 생성을 수행하는 핵심 기술입니다. 가장 보편적인 탐색 기법은 두 잠재 벡터 $z\_A \= E(x\_A)$와 $z\_B \= E(x\_B)$ 사이를 선형 보간(LERP: Linear Interpolation)하는 것입니다: $z(t) \= (1-t)z\_A \+ t z\_B$.

그러나 LERP는 $Z$ 공간이 유클리드 공간처럼 "평평하고 꽉 차 있다"고 암묵적으로 가정합니다. 이 가정은 MNIST와 같은 실제 데이터셋에서 쉽게 깨집니다. MNIST 데이터는 '0'부터 '9'까지 10개의 \*\*이산적인(discrete) 클래스 "섬"\*\*으로 구성됩니다. 인코더 $E$가 학습한 사후분포 $q(z)$ 역시 이러한 다중 모드(multi-modal) 구조를 반영해야 합니다. 하지만 LERP는 $z\_A$('7' 섬)에서 $z\_B$('9' 섬)로 이동할 때, 두 "섬" 사이에 데이터가 존재하지 않는 \*\*"저밀도 구멍(low-density hole)"\*\*을 직선으로 통과합니다. 생성기 $G$는 이 "구멍" 안의 $z\_{interp}$를 유효한 이미지로 디코딩하도록 학습된 적이 없으므로, 그 결과물 $G(z\_{interp})$는 \[image\_f725ef.png\]에서 보듯 "일그러진" \*\*시각적 아티팩트(visual artifact)\*\*가 됩니다.

이 문제를 해결하기 위해, 우리는 "구멍"을 감지하고 경로를 동적으로 수정하는 **스코어 기반 안내 보행(Score-Guided Walk, SGW)** 알고리즘을 제안합니다. 이 알고리즘은 "구멍"을 감지할 "센서"를 필요로 합니다. 우리는 이 센서로 \*\*적대적 오토인코더(AAE)\*\*의 \*\*잠재 공간 판별자($D\_z$)\*\*를 선택했습니다. AAE는 (1) $x \\to z$ 매핑을 위한 \*\*인코더($E$)\*\*와 (2) $z$ 공간의 밀도를 모델링하는 \*\*판별자($D\_z$)\*\*를 모두 갖춘 유일한 아키텍처이기 때문입니다.

우리의 **초기 가설**은, $D\_z$가 $z$ 공간의 밀도를 "신뢰할 수 있게" 모델링할 수 있으며, $z\_t$가 "구멍"(저밀도)에 빠졌을 때 $D\_z$의 그래디언트(스코어)를 \*\*복원력($\\vec{F}\_{\\text{correct}}$)\*\*으로 사용하면, $z\_t$가 "구멍"을 우회하여 "고밀도 Population 매니폴드"($\\mathcal{M}$)를 따라 이동하도록 안내할 수 있다는 것이었습니다.

본 논문은 이 가설을 검증하기 위한 일련의 실증적 실험을 제시합니다. 우리의 핵심 기여는 (1) $\\vec{F}\_{\\text{correct}}$가 $D\_z$ 스코어를 기반으로 \*\*성공적으로 활성화\*\*됨을 정량적으로 증명하고(SGW $\\neq$ LERP), (2) 그럼에도 불구하고 $G(z\_t)$가 \*\*여전히 아티팩트를 생성\*\*함을 시각적으로 보여줌으로써, $D\_z$가 감시하는 \\\*\\\*"사전 분포 매니폴드"($\\mathcal{M}\_z$)\\\*\\\*와 우리가 진짜 원하는 \*\*"시각적 충실도 매니폴드"($\\mathcal{M}\_x$)\*\* 사이에 \*\*근본적인 불일치(misalignment)\*\*가 존재함을 밝혀낸 것입니다.

## **2\. 관련 연구 (Related Work)**

### **2.1. 잠재 공간 보간법**

LERP와 SLERP는 가장 보편적인 탐색 기법입니다. StyleGAN은 $Z$ 공간 대신 더 분리된(disentangled) $W$ 공간에서 보간하면 시각적 품질이 향상됨을 보였으나, $W$ 공간 역시 "구멍" 문제를 근본적으로 해결하지는 못합니다.

### **2.2. 매니폴드 인지 탐색**

리만 계량(Riemannian Metrics)을 이용한 접근법은 $Z$ 공간이 $G$에 의해 유도된 "휘어진 공간"임을 인정합니다. $G$의 야코비안($J\_G(z)$)을 통해 계량 텐서를 계산하고 지오데식(최단 경로)을 찾으려 하지만, 이는 $J\_G(z)$ 계산으로 인한 엄청난 계산 비용이 발생하여 실용적이지 못합니다.

### **2.3. 스코어 기반 모델링 (Diffusion vs. AAE)**

우리의 접근 방식은 "스코어 함수"를 사용한다는 점에서 확산 모델(Diffusion Models)과 유사점을 갖지만, 그 대상과 목적이 근본적으로 다릅니다.

* **확산 모델 스코어:** $\\nabla\_x \\log p(x)$  
  * **공간:** \*\*픽셀 공간($x$)\*\*에서 작동합니다.  
  * **대상:** $P\_{data}(x)$ (실제 데이터의 밀도)를 모델링합니다.  
  * **의미:** $x$를 "더욱 진짜 이미지처럼" 만드는 픽셀 방향을 제시합니다. 즉, \*\*시각적 충실도(Fidelity)\*\*를 직접 다룹니다.  
* **AAE** $D\_z$ **스코어:** $\\nabla\_z D\_z(z)$  
  * **공간:** \*\*잠재 공간($z$)\*\*에서 작동합니다.  
  * **대상:** $P(z)$ (가우시안 Prior)와 $q(z)$ (데이터)를 구별하는 **판별자 함수**를 모델링합니다.  
  * **의미:** $z$를 "가우시안 Prior($P(z)$)에 더 가깝게" 만드는 $z$ 방향을 제시합니다. 즉, \*\*Prior 근접성(Proximity)\*\*을 다룹니다.

본 연구는 "Prior 근접성($D\_z$)"이 "시각적 충실도($D\_x$)"를 보장할 수 있다는 암묵적인 가설을 검증하며, **이 가설이 틀렸음**을 보이는 것을 핵심으로 합니다.

## **3\. 방법론 (Method)**

### **3.1. 적대적 오토인코더 (AAE)**

AAE는 $E$(인코더), $G$(디코더), $D\_z$(잠재 공간 판별자) 세 부분으로 구성됩니다.  
$E$와 $G$는 $L\_{\\text{recon}} \= \\|x \- G(E(x))\\|^2$ (재구성 손실)을 통해 오토인코더로 학습됩니다.  
동시에 $D\_z$와 $E$는 적대적 학습을 수행합니다:

1. $D\_z$**의 학습:** $P(z) \\sim \\mathcal{N}(0, I)$에서 샘플링한 $z\_{\\text{real}}$은 1(True)로, $E(x)$로 생성된 $z\_{\\text{fake}}$는 0(False)으로 판별하도록 학습됩니다.  
2. $E$**의 학습:** $E$는 $D\_z$가 $z\_{\\text{fake}} \= E(x)$를 1(True)로 착각하도록, 즉 $D\_z$를 속이도록 학습됩니다.

이 미니맥스 게임의 결과, $E(x)$로 생성된 $z$ 벡터 60,000개의 \*\*"집계된 사후분포(Aggregated Posterior)" $q(z)$\*\*가 $P(z)$의 분포($\\mathcal{N}(0, I)$)와 같아지도록 강제됩니다.

### **3.2. 에너지 최소값으로서의 매니폴드 ($\\mathcal{M}\_z$)**

AAE가 이상적인 \*\*"균형점(Equilibrium)"\*\*에 도달했다는 것은, $D\_z$가 $q(z)$와 $p(z)$를 더 이상 구별하지 못하는, 즉 확률 0.5를 출력하는 상태를 의미합니다. 우리가 사용하는 BCEWithLogitsLoss 기준, 이는 $D\_z(z)$의 **원시 로짓(logit) 출력이 0**이 됨을 의미합니다.

우리는 이 $D\_z=0$인 "이상적인" $P(z)$ 매니폴드, 즉 \*\*"Prior 매니폴드" ($\\mathcal{M}\_z$)\*\*를 탐색의 목표로 삼습니다. 이 $\\mathcal{M}\_z$를 "가장 낮은 골짜기"로 정의하기 위해, $z\_t$가 $\\mathcal{M}\_z$에서 얼마나 멀리 떨어져 있는지 측정하는 "에너지 함수" $E(z)$를 정의합니다.

$E(z) \= (D\_z(z))^2$ (로짓의 제곱)은 $z\_t$가 $\\mathcal{M}\_z$($D\_z=0$) 위에 있을 때만 $E=0$ (최소값)이 되고, "구멍"(Outlier, $D\_z \\neq 0$)에 빠지면 $E \> 0$이 되는 안정적인 손실 함수입니다.  
(주: 실제 구현에서는 $E(z)$가 "깊은 구멍"에서 Inf/NaN으로 폭발하는 것을 방지하기 위해, $(D\_z(z))^2$ 대신 $E(z) \= \\text{BCEWithLogitsLoss}(D\_z(z), 0)$라는 더 안정적인 함수를 사용했습니다.)

### **3.3. 스코어 기반 경로 최적화 (SGW 알고리즘)**

우리의 SGW 알고리즘은 $z\_A$에서 시작하여 $z\_B$에 도달할 때까지 매 스텝 $t$마다 $z\_{t+1}$을 다음 두 힘의 합으로 결정합니다.

$$z\_{t+1} \= z\_t \+ \\vec{F}\_{\\text{target}} \+ \\vec{F}\_{\\text{correct}} $$ \* \*\*목표 지향 힘 ($\\vec{F}\_{\\text{target}}$):\*\* $$  
$$\\\\vec{F}\\\_{\\\\text{target}} \= \\\\alpha \\\\cdot \\\\frac{z\\\_B \- z\\\_t}{|z\\\_B \- z\\\_t|\\\_2}

$$  
$$이것은 $z\_t$에서 $z\_B$로 향하는 "방향"(단위 벡터)에 "속도"($\\alpha$)를 곱한 힘입니다. $z\_t$를 $z\_B$로 일정하게 끌어당깁니다.

* **매니폴드 보정 힘 (**$\\vec{F}\_{\\text{correct}}$**):**$$ \\\\ \\vec{F}\*{\\text{correct}} \= \- \\beta \\cdot \\nabla\*{z\\\_t} E(z\\\_t) $$  
  $$$$이것은 $E(z\_t)$를 최소화(즉, 0)하는 방향으로 $z\_t$를 이끄는 \*\*그래디언트 하강(Gradient Descent)\*\*입니다. $z\_t$가 "구멍"($E\>0$)에 빠졌을 때, $z\_t$를 "이상적인 $\\mathcal{M}\_z$ 매니폴드"($E=0$, 즉 $D\_z \\approx 0.5$)로 되돌려 보내는 **"복원력"** 역할을 합니다.

이 알고리즘의 의사 코드는 다음과 같습니다. (구현 시 $\\nabla\_z E(z)$가 NaN/Inf로 폭발하는 것을 막기 위한 clamp 및 NaN 체크가 필수적입니다.)

1: z\_A ← E(x\_A), z\_B ← E(x\_B)  
2: z\_t ← z\_A  
3: P ← \[z\_t\]  
4: for t \= 0 to T\_max do  
5:     d ← ||z\_B \- z\_t||  
6:     if d \< ε then break  
7:  
8:     // 1\. 목표 지향 힘  
9:     v\_target ← (z\_B \- z\_t) / d  
10:    F\_target ← α \* v\_target  
11:  
12:    // 2\. 보정 힘  
13:    logit ← D\_z(z\_t)  
14:    E ← BCE(logit, 0\) // 또는 (logit)^2  
15:    E.backward()  
16:    grad\_g ← z\_t.grad.clamp(-1, 1\) // NaN 방지  
17:    F\_correct ← \-β \* grad\_g  
18:  
19:    // 3\. 스텝 업데이트  
20:    z\_t ← z\_t \+ F\_target \+ F\_correct  
21:    P.append(z\_t)  
22: return P

## **4\. 실험 및 분석 (Experimental Analysis)**

우리의 가설($D\_z$ 센서가 아티팩트 경로를 우회시킨다)을 검증하기 위해, $D\_z$의 "센서 품질"이 다른 두 가지 AAE 모델을 학습하고 비교했습니다.

### **4.1. 실험 1: $D\_z$ 센서의 "학습 실패" (Conv+WeakD 모델)**

먼저, 강력한 ConvNet 인코더($E$)와 디코더($G$)를 사용하되, 판별자($D\_z$)는 약한 Linear 넷으로 구성하여 $E$**/**$D\_z$ **불균형**을 유도했습니다.

* 결과 (D(z) 스코어 분포): (뾰족한 0.5 스파이크)  
  $D\_z$는 $E$와의 힘의 균형에서 "패배"하여, $q(z)$(데이터)와 $p(z)$(Prior)를 구별하는 것을 "포기"했습니다. 그 결과, $z$ 공간의 모든 지점($z\_t$)에 0.5점을 주는 "고장 난 센서"(상수 함수)가 되었습니다.  
* 결과 (SGW 탐색): (SGW 탐색 결과)  
  $D\_z(z\_t)$가 0.5(상수)이므로, $\\nabla\_z E(z\_t) \\approx 0$이 되어 \*\*$\\vec{F}\_{\\text{correct}} \\approx 0$\*\* (복원력 0)이 되었습니다. 그 결과, SGW는 $\\vec{F}\_{\\text{target}}$(전진력)만으로 작동하여 LERP와 100% 동일한 경로를 탐색했고, "스코어 플롯"은 0.5 수평선, "거리 플롯"은 선형을 그렸습니다.  
* **결론:** 이 모델은 $\\vec{F}\_{\\text{correct}}$가 활성화되지 않아 가설 검증이 불가능했습니다.

### **4.2. 실험 2: $D\_z$ 센서의 "작동"과 "근본적 한계" (Linear 모델)**

다음으로, $E$, $G$, $D\_z$가 모두 Linear 넷으로 구성되어 $E$**/**$D\_z$ **균형**이 잘 맞았던 모델을 사용했습니다.

* 결과 (D(z) 스코어 분포): (넓은 종 모양)  
  $D\_z$가 "포기"하지 않고 $z$ 공간의 밀도를 "신뢰할 수 있게 모델링"했습니다. $z$가 $P(z)$ 중심부(고밀도)에 있으면 0.5점을, "구멍"(Outlier, 저밀도)에 있으면 0.5가 아닌 값(예: 0.2점, 0.8점)을 부여하는 \*\*"유효한 센서"\*\*로 작동했습니다.  
* \[핵심 실험\] 4.2.1: Outlier (구멍) 탐색: SGW vs LERP  
  우리는 이 "유효한 센서"를 이용해, $D\_z$ 스코어가 0.5가 아닌 "구멍"(Outlier)에서 탐색을 시작했습니다 (예: "High Score $\\to$ High Score", $z\_A, z\_B$ 스코어 $\\approx 0.85$).  
  * 정량적 결과 (스코어/거리): (SGW: 파란색, LERP: 주황색)  
    LERP(주황색)는 0.8점대의 "구멍"에 머무릅니다. 반면, \*\*SGW(파란색)\*\*는 $z\_t$가 $z\_A$를 떠나자마자, 활성화된 $\\vec{F}\_{\\text{correct}}$(복원력)에 의해 0.5점("이상적인" $\\mathcal{M}\_z$)으로 강하게 이끌려 내려옵니다.  
    $\\implies$ 가설 검증 1: $D\_z$ 센서는 작동하며, $\\vec{F}\_{\\text{correct}}$는 0이 아닙니다 (SGW $\\neq$ LERP).  
  * 정성적 결과 (이미지): (SGW: 상단, LERP: 하단)  
    $\\vec{F}\_{\\text{correct}}$에 의해 0.5점 매니폴드로 "성공적으로 복원된" \*\*SGW 경로(상단)의 이미지들\*\*이, LERP 경로(하단)와 마찬가지로 \*\*여전히 시각적인 아티팩트\*\*입니다.  
    \*\*$\\implies$ 가설 검증 2: $D\_z$가 "이상적"($\\mathcal{M}\_z$)이라고 판단한 0.5점 영역이, $G$에게는 여전히 "아티팩트" 영역($\\mathcal{M}\_x$ 밖)이었습니다.\*\*

## **5\. 결론 (Conclusion)**

본 연구는 AAE의 $D\_z$ 스코어를 "복원력"($\\vec{F}\_{\\text{correct}}$)으로 사용하는 SGW 탐색 알고리즘을 제안하고, 이 가설을 실증적으로 검증했습니다.

우리의 핵심 발견은 이 가설이 **절반의 성공과 절반의 실패**를 동시에 보여준다는 것입니다. 우리는 \[image\_2c71a2.png\]를 통해 $\\vec{F}\_{\\text{correct}}$가 $\\nabla\_z D\_z$를 기반으로 **성공적으로 활성화**되어 LERP와 다른 경로를 탐색함을 증명했습니다.

하지만, 우리는 \[image\_2c6efc.png\]를 통해 $D\_z$가 "복원"시킨 "이상적인 $P(z)$ 매니폴드"($\\mathcal{M}\_z$)가 여전히 **시각적 아티팩트**를 생성함을 보임으로써, 이 접근법의 **근본적인 한계**를 동시에 밝혀냈습니다.

이 한계는 AAE의 $N(0, I)$ Prior 강제성에서 비롯됩니다. $D\_z$는 $z$가 \*\*$P(z)$(가우시안 Prior)\*\*에 얼마나 가까운지만 측정할 뿐, $G(z)$가 \\\*\\\*$P\_{data}(x)$(실제 숫자)\\\*\\\*에 얼마나 가까운지는 측정하지 못합니다. \*\*$\\mathcal{M}\_z$(Prior 매니폴드)와 $\\mathcal{M}\_x$(Fidelity 매니폴드)는 일치하지 않습니다.\*\*

"신뢰할 수 있는" 잠재 공간 탐색을 위해서는, $D\_z$ 스코어(Prior 근접성)만으로는 불충분하며, $G(z)$의 시각적 충실도를 직접 평가하는 접근법이 필요함을 강력히 시사합니다.

## **6\. 향후 연구 (Future Work)**

본 연구가 밝혀낸 $D\_z$의 근본적인 한계($\\mathcal{M}\_z \\neq \\mathcal{M}\_x$)를 극복하기 위한 다음 단계는, $G(z)$의 시각적 품질을 직접 평가하는 \*\*"디코더 인지 보정(Decoder-Aware Correction)"\*\*입니다.

이를 위해 $\\vec{F}\_{\\text{correct}}$는 $z$ 공간의 "구멍"을 감시하는 $\\vec{F}\_z$와, 픽셀 공간의 "아티팩트"를 감시하는 \\\*\\\*$\\vec{F}\_x$\*\*의 가중치 합으로 재정의되어야 합니다.

$$\\vec{F}\_{\\text{total\\\_correct}} \= \-\\beta\_z \\cdot \\nabla\_{z} E\_z(z\_t) \\underbrace{-\\beta\_x \\cdot \\nabla\_{z} E\_x(G(z\_t))}\_{\\vec{F}\_x (\\text{x-센서})} $$여기서 $\\vec{F}\_x$는 (GAN의 생성자처럼) 픽셀 판별자 $D\_x$를 속여 $G(z\_t)$가 "더 진짜 숫자처럼" 보이도록 $z\_t$를 수정하는 힘입니다. 이 \*\*"이중 센서(Dual-Sensor)"\*\* 접근법이 $P(z)$의 통계와 $P\_{data}(x)$의 충실도를 모두 만족시키는 진정한 "신뢰할 수 있는" 경로 탐색의 해답이 될 것입니다.$$